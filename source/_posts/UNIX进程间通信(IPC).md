---
title: UNIX进程间通信(IPC)
date: 2020-07-27 00:40:00
tags: [进程间通信,操作系统]
categories: 编程
toc: true
---

<img src="https://s1.ax1x.com/2020/07/27/aCHlff.jpg" alt="IPC" style="zoom: 50%;" />

进程间通信(IPC)，顾名思义，就是实现两个进程间通信交流的一种方式。这种通信交流的目的一般是为了进行数据传输、通知事件或者进程资源共享等等。
<!--more-->

#### 进程间通信 
由于虚拟内存的关系，对于所有进程来说，它们只能看到操作系统想让他们看到的虚拟地址空间，这块空间是每个进程的私有财产，这部分私有财产受到操作系统的保护，别的进程是无法进行随意访问的。

任何内存越界的行为都可能直接导致程序崩溃，因此，无论出于什么目的，想要访问一块不属于进程自身的地址空间时，就需要使用到进程间通信了。

#### 进程间通信的发展历史

Linux下的进程通信手段基本上是从Unix平台上的进程通信手段继承而来的。而对Unix发展做出重大贡献的两大主力AT&T的贝尔实验室及BSD（加州大学伯克利分校的伯克利软件发布中心），在进程间通信方面的侧重点有所不同。前者对Unix早期的进程间通信手段进行了系统的改进和扩充，形成了“System V IPC”，通信进程局限在单个计算机内；后者则跳过了该限制，形成了基于套接口（socket）的进程间通信机制。Linux则把两者继承了下来。

<img src="https://s1.ax1x.com/2020/07/31/a1waJ1.jpg" alt="Linux IPC" style="zoom: 33%;" />

最初Unix IPC包括：管道(PIPE)、FIFO、信号(signal)；

System V IPC包括：System V 消息队列、System V 信号灯、System V 共享内存区；

POSIXIPC包括： POSIX消息队列、POSIX信号灯、POSIX共享内存区。

需要指出的是：POSIX是Portable Operating System Interface（可移植操作系统接口）的缩写。POSIX 是由 IEEE 指定的一系列标准，以阐明和统一应用程序编程接口；如果你使用了某些POSIX并未进行标准化的API时，在将该程序或者库移植到其他的类UNIX系统中时，会遇到很大的麻烦。同时，Socket虽然常用于网络通信，但他同时也可以用于本机内的不同进程间的通信(Unix domain socket)。

本文以下的介绍基于POSIX标准。

#### 1、管道(PIPE)

​    管道是一种较为古老的进程间通信方式，我们一般所说的PIPE属于```匿名管道```，而后面将要说到的FIFO则是```命名管道```。管道的实际上是一个由内核管理的缓冲区，也可理解为一个文件(就像Linux中的任意一个普通文件一样)，我们可以对这块缓冲或者说文件进行写入和读取的操作，与操作文件的方式类似。

管道是一个单向通信的方式，也就是说先写输入管道的信息，一定会先被读取出来，即所谓的“先入先出”。同时，管道(这里指的是匿名管道，PIPE)只能够实现父子进程或是兄弟进程间的通信，无任何血缘关系的进程间无法通过PIPE来实现通信。

当我们在进程中创建一个PIPE之后，会在内存当中开辟出一块缓冲区，并且为进程返回两个文件描述符：fd[0]与fd[1]。其中，fd[0]连接了管道的读取端，而fd[1]连接了管道的写入端。我们向fd[1]里写入的数据可以从fd[0]中读取出来。当父进程调用fork创建出一个子后，子进程中的fd[0]与fd[1]同样指向内存中的这一块缓冲区，注意，父进程与 子进程的fd指向的是同一块内存。因此，如果需要实现父进程向子进程的通信，只需关闭父进程的读取端口，关闭子进程的写入端口即可。反之亦然。

#### 2、命名管道(FIFO)

#### 3、消息队列(MessageQueue)

#### 4、共享内存(SharedMemory)

#### 5、信号量(Semaphore)

#### 6、套接字(Socket)

#### 7、信号(sinal )